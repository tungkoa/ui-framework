{"code":"import { h, isSSR, render, _render } from './core.js';\nconst defineAsCustomElementsSSR = (component, componentName, _publicProps = [], _options = {}) => {\n    if (!/^[a-zA-Z0-9]+-[a-zA-Z0-9]+$/.test(componentName))\n        console.log(`Error: WebComponent name \"${componentName}\" is invalid.`);\n    else\n        _nano.customElements.set(componentName, component);\n};\nexport const defineAsCustomElements = function (component, componentName, publicProps, shadow) {\n    if (isSSR()) {\n        defineAsCustomElementsSSR(component, componentName, publicProps);\n        return;\n    }\n    customElements.define(componentName, class extends HTMLElement {\n        component;\n        $root;\n        isFunctionalComponent;\n        functionalComponentsProps;\n        constructor() {\n            super();\n            if (shadow) {\n                this.attachShadow(shadow);\n                this.$root = this.shadowRoot;\n            }\n            else {\n                this.$root = this;\n            }\n            let ref;\n            const el = this.buildEl(_render({\n                component,\n                props: {\n                    ref: (r) => (ref = r),\n                    children: Array.from(this.children).map(c => render(c))\n                }\n            }));\n            // ------------------------------ first render\n            this.component = ref;\n            this.isFunctionalComponent = !component.isClass;\n            this.functionalComponentsProps = {};\n            this.appendEl(el);\n            // ------------------------------------------\n            if (!this.isFunctionalComponent) {\n                this.component.updatePropsValue = (name, value) => {\n                    // @ts-ignore\n                    if (!this.component.props)\n                        this.component.props = {};\n                    this.component.props[name] = value;\n                    this.component[name] = value;\n                };\n            }\n        }\n        static get observedAttributes() {\n            return publicProps;\n        }\n        buildEl(contents) {\n            // because nano-jsx update needs parentElement, we need\n            // to wrap the element in a div when using shadow mode\n            return h(this.shadowRoot ? 'div' : 'template', null, contents);\n        }\n        appendEl(el) {\n            if (this.shadowRoot) {\n                // el.dataset.wcRoot = true\n                this.$root.append(el);\n            }\n            else {\n                this.$root.append(...el.childNodes);\n            }\n        }\n        removeChildren() {\n            if (this.$root) {\n                const children = Array.from(this.$root?.children) || [];\n                for (const el of children) {\n                    el.remove();\n                }\n            }\n        }\n        attributeChangedCallback(name, _, newValue) {\n            if (!this.isFunctionalComponent) {\n                this.component.updatePropsValue(name, newValue);\n                this.component.update();\n            }\n            else {\n                this.removeChildren();\n                this.functionalComponentsProps[name] = newValue;\n                const el = this.buildEl(_render({\n                    component,\n                    props: {\n                        children: [],\n                        ref: (r) => (this.component = r),\n                        ...this.functionalComponentsProps\n                    }\n                }));\n                this.appendEl(el);\n            }\n        }\n    });\n};\n//# sourceMappingURL=customElementsMode.js.map","references":["/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/core.ts"],"map":"{\"version\":3,\"file\":\"customElementsMode.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/customElementsMode.ts\"],\"names\":[],\"mappings\":\"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\"}","dtsmap":{"name":"./node_modules/.cache/.rts2_cache_cjs/placeholder/customElementsMode.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"customElementsMode.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/customElementsMode.ts\"],\"names\":[],\"mappings\":\"AAaA,eAAO,MAAM,sBAAsB,EAAE,CACnC,SAAS,EAAE,GAAG,EACd,aAAa,EAAE,MAAM,EACrB,WAAW,EAAE,MAAM,EAAE,EACrB,MAAM,CAAC,EAAE,cAAc,KACpB,IAyGJ,CAAA\"}"},"dts":{"name":"./node_modules/.cache/.rts2_cache_cjs/placeholder/customElementsMode.d.ts","writeByteOrderMark":false,"text":"export declare const defineAsCustomElements: (component: any, componentName: string, publicProps: string[], shadow?: ShadowRootInit) => void;\n//# sourceMappingURL=customElementsMode.d.ts.map"}}
