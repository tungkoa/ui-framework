{"code":"import { onNodeRemove } from './helpers.js';\nimport { tick, _render } from './core.js';\nimport { _state } from './state.js';\nexport class Component {\n    props;\n    id;\n    _elements = [];\n    _skipUnmount = false;\n    _hasUnmounted = false;\n    constructor(props) {\n        this.props = props || {};\n        this.id = this._getHash();\n    }\n    static get isClass() {\n        return true;\n    }\n    get isClass() {\n        return true;\n    }\n    setState(state, shouldUpdate = false) {\n        const isObject = typeof state === 'object' && state !== null;\n        // if state is an object, we merge the objects\n        if (isObject && this.state !== undefined)\n            this.state = { ...this.state, ...state };\n        // else, we just overwrite it\n        else\n            this.state = state;\n        if (shouldUpdate)\n            this.update();\n    }\n    set state(state) {\n        _state.set(this.id, state);\n    }\n    get state() {\n        return _state.get(this.id);\n    }\n    set initState(state) {\n        if (this.state === undefined)\n            this.state = state;\n    }\n    /** Returns all currently rendered node elements */\n    get elements() {\n        return this._elements || [];\n    }\n    set elements(elements) {\n        if (!Array.isArray(elements))\n            elements = [elements];\n        elements.forEach(element => {\n            this._elements.push(element);\n        });\n    }\n    _addNodeRemoveListener() {\n        // check if didUnmount is unused\n        if (/^[^{]+{\\s+}$/gm.test(this.didUnmount.toString()))\n            return;\n        // listen if the root elements gets removed\n        onNodeRemove(this.elements[0], () => {\n            if (!this._skipUnmount)\n                this._didUnmount();\n        });\n    }\n    // @ts-ignore\n    _didMount() {\n        this._addNodeRemoveListener();\n        this.didMount();\n    }\n    _willUpdate() {\n        this.willUpdate();\n    }\n    _didUpdate() {\n        this.didUpdate();\n    }\n    _didUnmount() {\n        if (this._hasUnmounted)\n            return;\n        this.didUnmount();\n        this._hasUnmounted = true;\n    }\n    willMount() { }\n    didMount() { }\n    willUpdate() { }\n    didUpdate() { }\n    didUnmount() { }\n    render(_update) { }\n    /** Will forceRender the component */\n    update(update) {\n        this._skipUnmount = true;\n        this._willUpdate();\n        // get all current rendered node elements\n        const oldElements = [...this.elements];\n        // clear\n        this._elements = [];\n        let el = this.render(update);\n        el = _render(el);\n        this.elements = el;\n        // console.log('old: ', oldElements)\n        // console.log('new: ', this.elements)\n        // get valid parent node\n        const parent = oldElements[0].parentElement;\n        // make sure we have a parent\n        if (!parent)\n            console.warn('Component needs a parent element to get updated!');\n        // add all new node elements\n        this.elements.forEach((child) => {\n            if (parent)\n                parent.insertBefore(child, oldElements[0]);\n        });\n        // remove all elements\n        oldElements.forEach((child) => {\n            // wee keep the element if it is the same, for example if passed as a child\n            if (!this.elements.includes(child)) {\n                child.remove();\n                // @ts-ignore\n                child = null;\n            }\n        });\n        // listen for node removal\n        this._addNodeRemoveListener();\n        // @ts-ignore\n        tick(() => {\n            this._skipUnmount = false;\n            if (!this.elements[0].isConnected)\n                this._didUnmount();\n            else\n                this._didUpdate();\n        });\n    }\n    _getHash() { }\n}\n//# sourceMappingURL=component.js.map","references":["/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/helpers.ts","/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/core.ts","/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/state.ts"],"map":"{\"version\":3,\"file\":\"component.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/component.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,cAAc,CAAA;AAC3C,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,EAAE,MAAM,EAAE,MAAM,YAAY,CAAA;AAEnC,MAAM,OAAO,SAAS;IACb,KAAK,CAAG;IACR,EAAE,CAAQ;IACT,SAAS,GAAkB,EAAE,CAAA;IAC7B,YAAY,GAAG,KAAK,CAAA;IACpB,aAAa,GAAG,KAAK,CAAA;IAE7B,YAAY,KAAQ;QAClB,IAAI,CAAC,KAAK,GAAG,KAAK,IAAI,EAAE,CAAA;QACxB,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAA;IAC3B,CAAC;IAEM,MAAM,KAAK,OAAO;QACvB,OAAO,IAAI,CAAA;IACb,CAAC;IAED,IAAW,OAAO;QAChB,OAAO,IAAI,CAAA;IACb,CAAC;IAED,QAAQ,CAAC,KAAQ,EAAE,eAAwB,KAAK;QAC9C,MAAM,QAAQ,GAAG,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,KAAK,IAAI,CAAA;QAE5D,8CAA8C;QAC9C,IAAI,QAAQ,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS;YAAE,IAAI,CAAC,KAAK,GAAG,EAAE,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,KAAK,EAAE,CAAA;QAClF,6BAA6B;;YACxB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAEvB,IAAI,YAAY;YAAE,IAAI,CAAC,MAAM,EAAE,CAAA;IACjC,CAAC;IAED,IAAI,KAAK,CAAC,KAAQ;QAChB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,KAAK,CAAC,CAAA;IAC5B,CAAC;IAED,IAAI,KAAK;QACP,OAAO,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAM,CAAA;IACjC,CAAC;IAED,IAAI,SAAS,CAAC,KAAQ;QACpB,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS;YAAE,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;IAClD,CAAC;IAED,mDAAmD;IACnD,IAAW,QAAQ;QACjB,OAAO,IAAI,CAAC,SAAS,IAAI,EAAE,CAAA;IAC7B,CAAC;IAED,IAAW,QAAQ,CAAC,QAAuB;QACzC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC;YAAE,QAAQ,GAAG,CAAC,QAAQ,CAAC,CAAA;QAEnD,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;YACzB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;IACJ,CAAC;IAEO,sBAAsB;QAC5B,gCAAgC;QAChC,IAAI,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;YAAE,OAAM;QAE7D,2CAA2C;QAC3C,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE;YAClC,IAAI,CAAC,IAAI,CAAC,YAAY;gBAAE,IAAI,CAAC,WAAW,EAAE,CAAA;QAC5C,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,aAAa;IACL,SAAS;QACf,IAAI,CAAC,sBAAsB,EAAE,CAAA;QAC7B,IAAI,CAAC,QAAQ,EAAE,CAAA;IACjB,CAAC;IAEO,WAAW;QACjB,IAAI,CAAC,UAAU,EAAE,CAAA;IACnB,CAAC;IAEO,UAAU;QAChB,IAAI,CAAC,SAAS,EAAE,CAAA;IAClB,CAAC;IAEO,WAAW;QACjB,IAAI,IAAI,CAAC,aAAa;YAAE,OAAM;QAC9B,IAAI,CAAC,UAAU,EAAE,CAAA;QACjB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;IAC3B,CAAC;IAEM,SAAS,KAAS,CAAC;IACnB,QAAQ,KAAS,CAAC;IAClB,UAAU,KAAS,CAAC;IACpB,SAAS,KAAS,CAAC;IACnB,UAAU,KAAS,CAAC;IAEpB,MAAM,CAAC,OAAa,IAAuB,CAAC;IAEnD,qCAAqC;IAC9B,MAAM,CAAC,MAAY;QACxB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAA;QACxB,IAAI,CAAC,WAAW,EAAE,CAAA;QAClB,yCAAyC;QACzC,MAAM,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAA;QAEtC,QAAQ;QACR,IAAI,CAAC,SAAS,GAAG,EAAE,CAAA;QAEnB,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;QAC5B,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC,CAAA;QAChB,IAAI,CAAC,QAAQ,GAAG,EAAS,CAAA;QAEzB,oCAAoC;QACpC,sCAAsC;QAEtC,wBAAwB;QACxB,MAAM,MAAM,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,aAA4B,CAAA;QAE1D,6BAA6B;QAC7B,IAAI,CAAC,MAAM;YAAE,OAAO,CAAC,IAAI,CAAC,kDAAkD,CAAC,CAAA;QAE7E,4BAA4B;QAC5B,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,KAAkB,EAAE,EAAE;YAC3C,IAAI,MAAM;gBAAE,MAAM,CAAC,YAAY,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,CAAA;QACxD,CAAC,CAAC,CAAA;QAEF,sBAAsB;QACtB,WAAW,CAAC,OAAO,CAAC,CAAC,KAAkB,EAAE,EAAE;YACzC,2EAA2E;YAC3E,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;gBACnC,KAAK,CAAC,MAAM,EAAE,CAAA;gBACd,aAAa;gBACb,KAAK,GAAG,IAAI,CAAA;YACd,CAAC;QACH,CAAC,CAAC,CAAA;QAEF,0BAA0B;QAC1B,IAAI,CAAC,sBAAsB,EAAE,CAAA;QAE7B,aAAa;QACb,IAAI,CAAC,GAAG,EAAE;YACR,IAAI,CAAC,YAAY,GAAG,KAAK,CAAA;YACzB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,WAAW;gBAAE,IAAI,CAAC,WAAW,EAAE,CAAA;;gBAChD,IAAI,CAAC,UAAU,EAAE,CAAA;QACxB,CAAC,CAAC,CAAA;IACJ,CAAC;IAEO,QAAQ,KAAS,CAAC;CAC3B\"}","dtsmap":{"name":"./node_modules/.cache/.rts2_cache_es/placeholder/component.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"component.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/component.ts\"],\"names\":[],\"mappings\":\"AAIA,qBAAa,SAAS,CAAC,CAAC,SAAS,MAAM,GAAG,GAAG,EAAE,CAAC,GAAG,GAAG;IAC7C,KAAK,EAAE,CAAC,CAAA;IACR,EAAE,EAAE,MAAM,CAAA;IACjB,OAAO,CAAC,SAAS,CAAoB;IACrC,OAAO,CAAC,YAAY,CAAQ;IAC5B,OAAO,CAAC,aAAa,CAAQ;gBAEjB,KAAK,EAAE,CAAC;IAKpB,WAAkB,OAAO,YAExB;IAED,IAAW,OAAO,YAEjB;IAED,QAAQ,CAAC,KAAK,EAAE,CAAC,EAAE,YAAY,GAAE,OAAe;IAWhD,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC,EAEjB;IAED,IAAI,KAAK,IAJQ,CAAC,CAMjB;IAED,IAAI,SAAS,CAAC,KAAK,EAAE,CAAC,EAErB;IAED,mDAAmD;IACnD,IAAW,QAAQ,IAAI,WAAW,EAAE,CAEnC;IAED,IAAW,QAAQ,CAAC,QAAQ,EAAE,WAAW,EAAE,EAM1C;IAED,OAAO,CAAC,sBAAsB;IAW9B,OAAO,CAAC,SAAS;IAKjB,OAAO,CAAC,WAAW;IAInB,OAAO,CAAC,UAAU;IAIlB,OAAO,CAAC,WAAW;IAMZ,SAAS,IAAI,GAAG;IAChB,QAAQ,IAAI,GAAG;IACf,UAAU,IAAI,GAAG;IACjB,SAAS,IAAI,GAAG;IAChB,UAAU,IAAI,GAAG;IAEjB,MAAM,CAAC,OAAO,CAAC,EAAE,GAAG,GAAG,WAAW,GAAG,IAAI;IAEhD,qCAAqC;IAC9B,MAAM,CAAC,MAAM,CAAC,EAAE,GAAG;IAgD1B,OAAO,CAAC,QAAQ;CACjB\"}"},"dts":{"name":"./node_modules/.cache/.rts2_cache_es/placeholder/component.d.ts","writeByteOrderMark":false,"text":"export declare class Component<P extends Object = any, S = any> {\n    props: P;\n    id: string;\n    private _elements;\n    private _skipUnmount;\n    private _hasUnmounted;\n    constructor(props: P);\n    static get isClass(): boolean;\n    get isClass(): boolean;\n    setState(state: S, shouldUpdate?: boolean): void;\n    set state(state: S);\n    get state(): S;\n    set initState(state: S);\n    /** Returns all currently rendered node elements */\n    get elements(): HTMLElement[];\n    set elements(elements: HTMLElement[]);\n    private _addNodeRemoveListener;\n    private _didMount;\n    private _willUpdate;\n    private _didUpdate;\n    private _didUnmount;\n    willMount(): any;\n    didMount(): any;\n    willUpdate(): any;\n    didUpdate(): any;\n    didUnmount(): any;\n    render(_update?: any): HTMLElement | void;\n    /** Will forceRender the component */\n    update(update?: any): void;\n    private _getHash;\n}\n//# sourceMappingURL=component.d.ts.map"}}
