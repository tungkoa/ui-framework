{"code":"import { Component } from '../component.js';\nimport { appendChildren, h, isSSR } from '../core.js';\nclass Attributes extends Map {\n    toString() {\n        let string = '';\n        for (const [key, value] of this)\n            string += ` ${key}=\"${value}\"`;\n        return string.trim();\n    }\n}\nexport class Helmet extends Component {\n    static SSR(body) {\n        const reg = /(<helmet\\b[^>]*>)((.|\\r|\\n)*?)(<\\/helmet>)/gm;\n        // collect all elements\n        const head = [];\n        const footer = [];\n        const attributes = {\n            html: new Attributes(),\n            body: new Attributes()\n        };\n        // get what's in the head\n        if (typeof document !== 'undefined' && document.head) {\n            let children = [];\n            children = [].slice.call(document.head.children);\n            for (let i = 0; i < children.length; i++) {\n                // check if the same element already exists\n                if (head.indexOf(children[i]) === -1) {\n                    head.push(children[i]);\n                }\n            }\n        }\n        let result;\n        while ((result = reg.exec(body)) !== null) {\n            const first = result[1];\n            let second = result[2];\n            const regHTML = /<html\\s([^>]+)><\\/html>/gm;\n            const regBody = /<body\\s([^>]+)><\\/body>/gm;\n            const regAttr = /(\\w+)=\"([^\"]+)\"/gm;\n            let res = null;\n            // extract html attributes\n            body.match(regHTML)?.forEach(h => {\n                second = second.replace(h, '');\n                while ((res = regAttr.exec(h)) !== null) {\n                    attributes.html.set(res[1], res[2]);\n                }\n            });\n            // extract body attributes\n            body.match(regBody)?.forEach(b => {\n                second = second.replace(b, '');\n                while ((res = regAttr.exec(b)) !== null) {\n                    attributes.body.set(res[1], res[2]);\n                }\n            });\n            const toHead = first.includes('data-placement=\"head\"');\n            // do not add an element if it already exists\n            if (toHead && !head.includes(second))\n                head.push(second);\n            else if (!toHead && !footer.includes(second))\n                footer.push(second);\n        }\n        // clean the body from all matches\n        const cleanBody = body.replace(reg, '');\n        return {\n            body: cleanBody,\n            head: head,\n            footer: footer,\n            attributes\n        };\n    }\n    didMount() {\n        this.props.children.forEach((element) => {\n            // return if it is not an html element\n            if (!(element instanceof HTMLElement))\n                return;\n            const parent = this.props.footer ? document.body : document.head;\n            const tag = element.tagName;\n            let attrs = [];\n            // get the inner text\n            attrs.push(element.innerText);\n            // get all attributes\n            for (let attr = 0; attr < element.attributes.length; attr++) {\n                attrs.push(element.attributes.item(attr)?.name.toLowerCase());\n                attrs.push(element.attributes.item(attr)?.value.toLowerCase());\n            }\n            // handle special tags\n            if (tag === 'HTML' || tag === 'BODY') {\n                const htmlTag = document.getElementsByTagName(tag)[0];\n                for (let attr = 1; attr < attrs.length; attr += 2) {\n                    htmlTag.setAttribute(attrs[attr], attrs[attr + 1]);\n                }\n                return;\n            }\n            else if (tag === 'TITLE') {\n                const titleTags = document.getElementsByTagName('TITLE');\n                if (titleTags.length > 0) {\n                    const e = element;\n                    titleTags[0].text = e.text;\n                }\n                else {\n                    const titleTag = h('title', null, element.innerHTML);\n                    appendChildren(parent, [titleTag], false);\n                }\n                return;\n            }\n            // check if the element already exists\n            let exists = false;\n            attrs = attrs.sort();\n            const el = document.getElementsByTagName(tag);\n            for (let i = 0; i < el.length; i++) {\n                let attrs2 = [];\n                // get the inner text\n                attrs2.push(el[i].innerText);\n                for (let attr = 0; attr < el[i].attributes.length; attr++) {\n                    attrs2.push(el[i].attributes.item(attr)?.name.toLowerCase());\n                    attrs2.push(el[i].attributes.item(attr)?.value.toLowerCase());\n                }\n                attrs2 = attrs2.sort();\n                if (attrs.length > 0 && attrs2.length > 0 && JSON.stringify(attrs) === JSON.stringify(attrs2))\n                    exists = true;\n            }\n            // add to dom\n            if (!exists)\n                appendChildren(parent, [element], false);\n        });\n    }\n    render() {\n        const placement = this.props.footer ? 'footer' : 'head';\n        if (isSSR())\n            return h('helmet', { 'data-ssr': true, 'data-placement': placement }, this.props.children);\n        else\n            return [];\n    }\n}\n//# sourceMappingURL=helmet.js.map","references":["/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/component.ts","/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/core.ts"],"map":"{\"version\":3,\"file\":\"helmet.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/components/helmet.ts\"],\"names\":[],\"mappings\":\"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\"}","dtsmap":{"name":"./node_modules/.cache/.rts2_cache_es/placeholder/components/helmet.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"helmet.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/components/helmet.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,iBAAiB,CAAA;AAG3C,cAAM,UAAW,SAAQ,GAAG;IAC1B,QAAQ;CAKT;AAED,qBAAa,MAAO,SAAQ,SAAS;IACnC,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM;;;;;;;;;IAiEvB,QAAQ;IA+DR,MAAM;CAMP\"}"},"dts":{"name":"./node_modules/.cache/.rts2_cache_es/placeholder/components/helmet.d.ts","writeByteOrderMark":false,"text":"import { Component } from '../component.js';\ndeclare class Attributes extends Map {\n    toString(): string;\n}\nexport declare class Helmet extends Component {\n    static SSR(body: string): {\n        body: string;\n        head: string[];\n        footer: string[];\n        attributes: {\n            html: Attributes;\n            body: Attributes;\n        };\n    };\n    didMount(): void;\n    render(): any;\n}\nexport {};\n//# sourceMappingURL=helmet.d.ts.map"}}
