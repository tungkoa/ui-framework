{"code":"import { Component } from '../component.js';\nimport { Helmet } from './helmet.js';\nimport { h } from '../core.js';\nimport { Fragment } from '../fragment.js';\n/**\n * A simple Link component\n * Add <Link prefetch ..., to prefetch the html document\n * Add <Link prefetch=\"hover\" ..., to prefetch the html document on hovering over the link element.\n */\nexport class Link extends Component {\n    prefetchOnHover() {\n        this.elements[0].addEventListener('mouseover', () => this.addPrefetch(), { once: true });\n    }\n    prefetchOnVisible() {\n        const observer = new IntersectionObserver((entries, observer) => {\n            entries.forEach(entry => {\n                if (entry.isIntersecting) {\n                    observer.disconnect();\n                    this.addPrefetch();\n                }\n            });\n        }, { threshold: [0, 1] });\n        observer.observe(this.elements[0]);\n    }\n    addPrefetch() {\n        let doesAlreadyExist = false;\n        // check if it is already on the dom\n        const links = document.getElementsByTagName('link');\n        for (let i = 0; i < links.length; i++) {\n            // if it is not already on the dom, add it\n            if (links[i].getAttribute('rel') === 'prefetch' && links[i].getAttribute('href') === this.props.href) {\n                doesAlreadyExist = true;\n            }\n        }\n        if (!doesAlreadyExist) {\n            const prefetch = h('link', { rel: 'prefetch', href: this.props.href, as: 'document' });\n            document.head.appendChild(prefetch);\n        }\n    }\n    didMount() {\n        const { href, prefetch, delay = 0, back = false } = this.props;\n        if (back)\n            this.elements[0].addEventListener('click', (e) => {\n                e.preventDefault();\n                const target = e.target;\n                if (target.href === document.referrer)\n                    window.history.back();\n                else\n                    window.location.href = target.href;\n            });\n        if (delay > 0)\n            this.elements[0].addEventListener('click', (e) => {\n                e.preventDefault();\n                setTimeout(() => (window.location.href = href), delay);\n            });\n        if (prefetch) {\n            if (prefetch === 'hover')\n                this.prefetchOnHover();\n            else if (prefetch === 'visible')\n                this.prefetchOnVisible();\n            else\n                this.addPrefetch();\n        }\n    }\n    render() {\n        // separate children and prefetch from props\n        const { children, prefetch, back, ref, ...rest } = this.props;\n        // some warning messages\n        if (!this.props.href)\n            console.warn('Please add \"href\" to <Link>');\n        if (children.length !== 1)\n            console.warn('Please add ONE child to <Link> (<Link>child</Link>)');\n        const a = h('a', { ...rest }, ...children);\n        // if ssr\n        if (prefetch === true && !(typeof window !== 'undefined' && window.document)) {\n            // <link rel=\"prefetch\" href=\"/index.html\" as=\"document\"></link>\n            const link = h('link', { rel: 'prefetch', href: this.props.href, as: 'document' });\n            const helmet = h(Helmet, null, link);\n            return h(Fragment, null, [helmet, a]);\n        }\n        // if not ssr\n        else {\n            return a;\n        }\n    }\n}\n//# sourceMappingURL=link.js.map","references":["/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/component.ts","/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/components/helmet.ts","/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/core.ts","/Users/tungkoa/WebstormProjects/new-ui-framework/nano/src/fragment.ts"],"map":"{\"version\":3,\"file\":\"link.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/components/link.ts\"],\"names\":[],\"mappings\":\"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\"}","dtsmap":{"name":"./node_modules/.cache/.rts2_cache_umd/placeholder/components/link.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"link.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/components/link.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,iBAAiB,CAAA;AAK3C,UAAU,KAAK;IACb,CAAC,GAAG,EAAE,MAAM,GAAG,GAAG,CAAA;IAClB,QAAQ,CAAC,EAAE,OAAO,GAAG,OAAO,GAAG,SAAS,CAAA;IACxC,IAAI,EAAE,MAAM,CAAA;IACZ,IAAI,CAAC,EAAE,OAAO,CAAA;IACd,KAAK,CAAC,EAAE,MAAM,CAAA;CACf;AAED;;;;GAIG;AACH,qBAAa,IAAK,SAAQ,SAAS,CAAC,KAAK,CAAC;IACxC,eAAe;IAIf,iBAAiB;IAejB,WAAW;IAkBX,QAAQ;IAwBR,MAAM;CAuBP\"}"},"dts":{"name":"./node_modules/.cache/.rts2_cache_umd/placeholder/components/link.d.ts","writeByteOrderMark":false,"text":"import { Component } from '../component.js';\ninterface Props {\n    [key: string]: any;\n    prefetch?: boolean | 'hover' | 'visible';\n    href: string;\n    back?: boolean;\n    delay?: number;\n}\n/**\n * A simple Link component\n * Add <Link prefetch ..., to prefetch the html document\n * Add <Link prefetch=\"hover\" ..., to prefetch the html document on hovering over the link element.\n */\nexport declare class Link extends Component<Props> {\n    prefetchOnHover(): void;\n    prefetchOnVisible(): void;\n    addPrefetch(): void;\n    didMount(): void;\n    render(): any;\n}\nexport {};\n//# sourceMappingURL=link.d.ts.map"}}
