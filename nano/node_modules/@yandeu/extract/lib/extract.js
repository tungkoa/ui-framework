"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.extract = void 0;
var fs_1 = __importDefault(require("fs"));
var path_1 = __importDefault(require("path"));
var const_1 = require("./const");
var error_1 = require("./error");
var output_1 = require("./output");
var extract = function (args, filename, testing) {
    if (testing === void 0) { testing = true; }
    if (args.length < 1)
        return error_1.error();
    if (!filename)
        return error_1.error();
    var KEYS = args;
    var FILENAME = filename.replace(/^\.?\//, '');
    if (!FILENAME)
        return error_1.error();
    var _tmp = fs_1.default.readFileSync(path_1.default.resolve(!testing ? './package.json' : './test/package.test.json'), {
        encoding: 'utf-8'
    });
    var json = JSON.parse(_tmp);
    var isESM = /\.tsx?|mjs$/.test(FILENAME);
    var isCJS = /\.jsx?|cjs$/.test(FILENAME);
    if (!isESM && !isCJS)
        error_1.error(const_1.PACKAGE_NAME + ": File extension has to be .js .jsx .cjs .ts .tsx or .mjs");
    return output_1.output(KEYS, FILENAME, json, isESM, testing);
};
exports.extract = extract;
