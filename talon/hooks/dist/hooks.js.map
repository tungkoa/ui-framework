{"version":3,"file":"hooks.js","sources":["../src/index.js"],"sourcesContent":["import { options as _options } from 'talon';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {import('./internal').Component} */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\n// Cast to use internal Options type\nconst options = /** @type {import('./internal').Options} */ (_options);\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\nlet oldRoot = options._root;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._root = (vnode, parentDom) => {\n\tif (vnode && parentDom._children && parentDom._children._mask) {\n\t\tvnode._mask = parentDom._children._mask;\n\t}\n\n\tif (oldRoot) oldRoot(vnode, parentDom);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\tif (previousComponent === currentComponent) {\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentComponent._renderCallbacks = [];\n\t\t\thooks._list.forEach(hookItem => {\n\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t}\n\t\t\t\thookItem._pendingArgs = hookItem._nextValue = undefined;\n\t\t\t});\n\t\t} else {\n\t\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentIndex = 0;\n\t\t}\n\t}\n\tpreviousComponent = currentComponent;\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tif (c.__hooks._pendingEffects.length) afterPaint(afterPaintEffects.push(c));\n\t\tc.__hooks._list.forEach(hookItem => {\n\t\t\tif (hookItem._pendingArgs) {\n\t\t\t\thookItem._args = hookItem._pendingArgs;\n\t\t\t}\n\t\t\thookItem._pendingArgs = undefined;\n\t\t});\n\t}\n\tpreviousComponent = currentComponent = null;\n};\n\n// TODO: Improve typing of commitQueue parameter\n/** @type {(vnode: import('./internal').VNode, commitQueue: any) => void} */\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tlet hasErrored;\n\t\tc.__hooks._list.forEach(s => {\n\t\t\ttry {\n\t\t\t\tinvokeCleanup(s);\n\t\t\t} catch (e) {\n\t\t\t\thasErrored = e;\n\t\t\t}\n\t\t});\n\t\tc.__hooks = undefined;\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\n\treturn hooks._list[index];\n}\n\n/**\n * @template {unknown} S\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} [initialState]\n * @returns {[S, (state: S) => void]}\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @template {unknown} S\n * @template {unknown} A\n * @param {import('./index').Reducer<S, A>} reducer\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ S, (state: S) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst currentValue = hookState._nextValue\n\t\t\t\t\t? hookState._nextValue[0]\n\t\t\t\t\t: hookState._value[0];\n\t\t\t\tconst nextValue = hookState._reducer(currentValue, action);\n\n\t\t\t\tif (currentValue !== nextValue) {\n\t\t\t\t\thookState._nextValue = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\n\t\tif (!currentComponent._hasScuFromHooks) {\n\t\t\tcurrentComponent._hasScuFromHooks = true;\n\t\t\tlet prevScu = currentComponent.shouldComponentUpdate;\n\t\t\tconst prevCWU = currentComponent.componentWillUpdate;\n\n\t\t\t// If we're dealing with a forced update `shouldComponentUpdate` will\n\t\t\t// not be called. But we use that to update the hook values, so we\n\t\t\t// need to call it.\n\t\t\tcurrentComponent.componentWillUpdate = function (p, s, c) {\n\t\t\t\tif (this._force) {\n\t\t\t\t\tlet tmp = prevScu;\n\t\t\t\t\t// Clear to avoid other sCU hooks from being called\n\t\t\t\t\tprevScu = undefined;\n\t\t\t\t\tupdateHookState(p, s, c);\n\t\t\t\t\tprevScu = tmp;\n\t\t\t\t}\n\n\t\t\t\tif (prevCWU) prevCWU.call(this, p, s, c);\n\t\t\t};\n\n\t\t\t// This SCU has the purpose of bailing out after repeated updates\n\t\t\t// to stateful hooks.\n\t\t\t// we store the next value in _nextValue[0] and keep doing that for all\n\t\t\t// state setters, if we have next states and\n\t\t\t// all next states within a component end up being equal to their original state\n\t\t\t// we are safe to bail out for this specific component.\n\t\t\t/**\n\t\t\t *\n\t\t\t * @type {import('./internal').Component[\"shouldComponentUpdate\"]}\n\t\t\t */\n\t\t\t// @ts-ignore - We don't use TS to downtranspile\n\t\t\t// eslint-disable-next-line no-inner-declarations\n\t\t\tfunction updateHookState(p, s, c) {\n\t\t\t\tif (!hookState._component.__hooks) return true;\n\n\t\t\t\t/** @type {(x: import('./internal').HookState) => x is import('./internal').ReducerHookState} */\n\t\t\t\tconst isStateHook = x => !!x._component;\n\t\t\t\tconst stateHooks =\n\t\t\t\t\thookState._component.__hooks._list.filter(isStateHook);\n\n\t\t\t\tconst allHooksEmpty = stateHooks.every(x => !x._nextValue);\n\t\t\t\t// When we have no updated hooks in the component we invoke the previous SCU or\n\t\t\t\t// traverse the VDOM tree further.\n\t\t\t\tif (allHooksEmpty) {\n\t\t\t\t\treturn prevScu ? prevScu.call(this, p, s, c) : true;\n\t\t\t\t}\n\n\t\t\t\t// We check whether we have components with a nextValue set that\n\t\t\t\t// have values that aren't equal to one another this pushes\n\t\t\t\t// us to update further down the tree\n\t\t\t\tlet shouldUpdate = false;\n\t\t\t\tstateHooks.forEach(hookItem => {\n\t\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\t\tconst currentValue = hookItem._value[0];\n\t\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t\t\thookItem._nextValue = undefined;\n\t\t\t\t\t\tif (currentValue !== hookItem._value[0]) shouldUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn shouldUpdate || hookState._component.props !== p\n\t\t\t\t\t? prevScu\n\t\t\t\t\t\t? prevScu.call(this, p, s, c)\n\t\t\t\t\t\t: true\n\t\t\t\t\t: false;\n\t\t\t}\n\n\t\t\tcurrentComponent.shouldComponentUpdate = updateHookState;\n\t\t}\n\t}\n\n\treturn hookState._nextValue || hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\n/** @type {(initialValue: unknown) => unknown} */\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') {\n\t\t\t\tref(createHandle());\n\t\t\t\treturn () => ref(null);\n\t\t\t} else if (ref) {\n\t\t\t\tref.current = createHandle();\n\t\t\t\treturn () => (ref.current = null);\n\t\t\t}\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @template {unknown} T\n * @param {() => T} factory\n * @param {unknown[]} args\n * @returns {T}\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState<T>} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {unknown[]} args\n * @returns {() => void}\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').TalonContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(\n\t\t\tformatter ? formatter(value) : /** @type {any}*/ (value)\n\t\t);\n\t}\n}\n\n/**\n * @param {(error: unknown, errorInfo: import('talon').ErrorInfo) => void} cb\n * @returns {[unknown, () => void]}\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = (err, errorInfo) => {\n\t\t\tif (state._value) state._value(err, errorInfo);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/** @type {() => string} */\nexport function useId() {\n\t/** @type {import('./internal').IdHookState} */\n\tconst state = getHookState(currentIndex++, 11);\n\tif (!state._value) {\n\t\t// Grab either the root node or the nearest async boundary node.\n\t\t/** @type {import('./internal.d').VNode} */\n\t\tlet root = currentComponent._vnode;\n\t\twhile (root !== null && !root._mask && root._parent !== null) {\n\t\t\troot = root._parent;\n\t\t}\n\n\t\tlet mask = root._mask || (root._mask = [0, 0]);\n\t\tstate._value = 'P' + mask[0] + '-' + mask[1]++;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tlet component;\n\twhile ((component = afterPaintEffects.shift())) {\n\t\tif (!component._parentDom || !component.__hooks) continue;\n\t\ttry {\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t} catch (e) {\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t}\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n * @returns {void}\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').HookState} hook\n * @returns {void}\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tlet cleanup = hook._cleanup;\n\tif (typeof cleanup == 'function') {\n\t\thook._cleanup = undefined;\n\t\tcleanup();\n\t}\n\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n * @returns {void}\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {unknown[]} oldArgs\n * @param {unknown[]} newArgs\n * @returns {boolean}\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\n/**\n * @template Arg\n * @param {Arg} arg\n * @param {(arg: Arg) => any} f\n * @returns {any}\n */\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n"],"names":["currentIndex","currentComponent","previousComponent","currentHook","afterPaintEffects","options","_options","oldBeforeDiff","_diff","oldBeforeRender","_render","oldAfterDiff","diffed","oldCommit","_commit","oldBeforeUnmount","unmount","oldRoot","_root","RAF_TIMEOUT","prevRaf","vnode","parentDom","_children","_mask","_component","hooks","__hooks","_pendingEffects","_renderCallbacks","_list","forEach","hookItem","_nextValue","_value","_pendingArgs","undefined","invokeCleanup","invokeEffect","c","length","afterPaint","push","_args","commitQueue","some","component","filter","cb","e","_catchError","_vnode","hasErrored","s","getHookState","index","type","_hook","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_reducer","action","currentValue","nextValue","setState","_hasScuFromHooks","updateHookState","p","isStateHook","x","stateHooks","allHooksEmpty","every","prevScu","call","shouldUpdate","props","shouldComponentUpdate","prevCWU","componentWillUpdate","_force","tmp","useEffect","callback","args","state","_skipEffects","argsChanged","useLayoutEffect","useRef","initialValue","useMemo","current","useImperativeHandle","ref","createHandle","concat","factory","_factory","useCallback","useContext","context","provider","_id","_context","_defaultValue","sub","value","useDebugValue","formatter","useErrorBoundary","errState","componentDidCatch","err","errorInfo","useId","root","_parent","mask","flushAfterPaintEffects","shift","_parentDom","HAS_RAF","requestAnimationFrame","afterNextFrame","done","clearTimeout","timeout","cancelAnimationFrame","raf","setTimeout","newQueueLength","hook","comp","cleanup","_cleanup","oldArgs","newArgs","arg","f"],"mappings":"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"}