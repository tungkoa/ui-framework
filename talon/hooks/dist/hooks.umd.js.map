{"version":3,"file":"hooks.umd.js","sources":["../src/index.js"],"sourcesContent":["import { options as _options } from 'talon';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {import('./internal').Component} */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\n// Cast to use internal Options type\nconst options = /** @type {import('./internal').Options} */ (_options);\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\nlet oldRoot = options._root;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._root = (vnode, parentDom) => {\n\tif (vnode && parentDom._children && parentDom._children._mask) {\n\t\tvnode._mask = parentDom._children._mask;\n\t}\n\n\tif (oldRoot) oldRoot(vnode, parentDom);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\tif (previousComponent === currentComponent) {\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentComponent._renderCallbacks = [];\n\t\t\thooks._list.forEach(hookItem => {\n\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t}\n\t\t\t\thookItem._pendingArgs = hookItem._nextValue = undefined;\n\t\t\t});\n\t\t} else {\n\t\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentIndex = 0;\n\t\t}\n\t}\n\tpreviousComponent = currentComponent;\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tif (c.__hooks._pendingEffects.length) afterPaint(afterPaintEffects.push(c));\n\t\tc.__hooks._list.forEach(hookItem => {\n\t\t\tif (hookItem._pendingArgs) {\n\t\t\t\thookItem._args = hookItem._pendingArgs;\n\t\t\t}\n\t\t\thookItem._pendingArgs = undefined;\n\t\t});\n\t}\n\tpreviousComponent = currentComponent = null;\n};\n\n// TODO: Improve typing of commitQueue parameter\n/** @type {(vnode: import('./internal').VNode, commitQueue: any) => void} */\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tlet hasErrored;\n\t\tc.__hooks._list.forEach(s => {\n\t\t\ttry {\n\t\t\t\tinvokeCleanup(s);\n\t\t\t} catch (e) {\n\t\t\t\thasErrored = e;\n\t\t\t}\n\t\t});\n\t\tc.__hooks = undefined;\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\n\treturn hooks._list[index];\n}\n\n/**\n * @template {unknown} S\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} [initialState]\n * @returns {[S, (state: S) => void]}\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @template {unknown} S\n * @template {unknown} A\n * @param {import('./index').Reducer<S, A>} reducer\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ S, (state: S) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst currentValue = hookState._nextValue\n\t\t\t\t\t? hookState._nextValue[0]\n\t\t\t\t\t: hookState._value[0];\n\t\t\t\tconst nextValue = hookState._reducer(currentValue, action);\n\n\t\t\t\tif (currentValue !== nextValue) {\n\t\t\t\t\thookState._nextValue = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\n\t\tif (!currentComponent._hasScuFromHooks) {\n\t\t\tcurrentComponent._hasScuFromHooks = true;\n\t\t\tlet prevScu = currentComponent.shouldComponentUpdate;\n\t\t\tconst prevCWU = currentComponent.componentWillUpdate;\n\n\t\t\t// If we're dealing with a forced update `shouldComponentUpdate` will\n\t\t\t// not be called. But we use that to update the hook values, so we\n\t\t\t// need to call it.\n\t\t\tcurrentComponent.componentWillUpdate = function (p, s, c) {\n\t\t\t\tif (this._force) {\n\t\t\t\t\tlet tmp = prevScu;\n\t\t\t\t\t// Clear to avoid other sCU hooks from being called\n\t\t\t\t\tprevScu = undefined;\n\t\t\t\t\tupdateHookState(p, s, c);\n\t\t\t\t\tprevScu = tmp;\n\t\t\t\t}\n\n\t\t\t\tif (prevCWU) prevCWU.call(this, p, s, c);\n\t\t\t};\n\n\t\t\t// This SCU has the purpose of bailing out after repeated updates\n\t\t\t// to stateful hooks.\n\t\t\t// we store the next value in _nextValue[0] and keep doing that for all\n\t\t\t// state setters, if we have next states and\n\t\t\t// all next states within a component end up being equal to their original state\n\t\t\t// we are safe to bail out for this specific component.\n\t\t\t/**\n\t\t\t *\n\t\t\t * @type {import('./internal').Component[\"shouldComponentUpdate\"]}\n\t\t\t */\n\t\t\t// @ts-ignore - We don't use TS to downtranspile\n\t\t\t// eslint-disable-next-line no-inner-declarations\n\t\t\tfunction updateHookState(p, s, c) {\n\t\t\t\tif (!hookState._component.__hooks) return true;\n\n\t\t\t\t/** @type {(x: import('./internal').HookState) => x is import('./internal').ReducerHookState} */\n\t\t\t\tconst isStateHook = x => !!x._component;\n\t\t\t\tconst stateHooks =\n\t\t\t\t\thookState._component.__hooks._list.filter(isStateHook);\n\n\t\t\t\tconst allHooksEmpty = stateHooks.every(x => !x._nextValue);\n\t\t\t\t// When we have no updated hooks in the component we invoke the previous SCU or\n\t\t\t\t// traverse the VDOM tree further.\n\t\t\t\tif (allHooksEmpty) {\n\t\t\t\t\treturn prevScu ? prevScu.call(this, p, s, c) : true;\n\t\t\t\t}\n\n\t\t\t\t// We check whether we have components with a nextValue set that\n\t\t\t\t// have values that aren't equal to one another this pushes\n\t\t\t\t// us to update further down the tree\n\t\t\t\tlet shouldUpdate = false;\n\t\t\t\tstateHooks.forEach(hookItem => {\n\t\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\t\tconst currentValue = hookItem._value[0];\n\t\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t\t\thookItem._nextValue = undefined;\n\t\t\t\t\t\tif (currentValue !== hookItem._value[0]) shouldUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn shouldUpdate || hookState._component.props !== p\n\t\t\t\t\t? prevScu\n\t\t\t\t\t\t? prevScu.call(this, p, s, c)\n\t\t\t\t\t\t: true\n\t\t\t\t\t: false;\n\t\t\t}\n\n\t\t\tcurrentComponent.shouldComponentUpdate = updateHookState;\n\t\t}\n\t}\n\n\treturn hookState._nextValue || hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\n/** @type {(initialValue: unknown) => unknown} */\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') {\n\t\t\t\tref(createHandle());\n\t\t\t\treturn () => ref(null);\n\t\t\t} else if (ref) {\n\t\t\t\tref.current = createHandle();\n\t\t\t\treturn () => (ref.current = null);\n\t\t\t}\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @template {unknown} T\n * @param {() => T} factory\n * @param {unknown[]} args\n * @returns {T}\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState<T>} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {unknown[]} args\n * @returns {() => void}\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').TalonContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(\n\t\t\tformatter ? formatter(value) : /** @type {any}*/ (value)\n\t\t);\n\t}\n}\n\n/**\n * @param {(error: unknown, errorInfo: import('talon').ErrorInfo) => void} cb\n * @returns {[unknown, () => void]}\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = (err, errorInfo) => {\n\t\t\tif (state._value) state._value(err, errorInfo);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/** @type {() => string} */\nexport function useId() {\n\t/** @type {import('./internal').IdHookState} */\n\tconst state = getHookState(currentIndex++, 11);\n\tif (!state._value) {\n\t\t// Grab either the root node or the nearest async boundary node.\n\t\t/** @type {import('./internal.d').VNode} */\n\t\tlet root = currentComponent._vnode;\n\t\twhile (root !== null && !root._mask && root._parent !== null) {\n\t\t\troot = root._parent;\n\t\t}\n\n\t\tlet mask = root._mask || (root._mask = [0, 0]);\n\t\tstate._value = 'P' + mask[0] + '-' + mask[1]++;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tlet component;\n\twhile ((component = afterPaintEffects.shift())) {\n\t\tif (!component._parentDom || !component.__hooks) continue;\n\t\ttry {\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t} catch (e) {\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t}\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n * @returns {void}\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').HookState} hook\n * @returns {void}\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tlet cleanup = hook._cleanup;\n\tif (typeof cleanup == 'function') {\n\t\thook._cleanup = undefined;\n\t\tcleanup();\n\t}\n\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n * @returns {void}\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {unknown[]} oldArgs\n * @param {unknown[]} newArgs\n * @returns {boolean}\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\n/**\n * @template Arg\n * @param {Arg} arg\n * @param {(arg: Arg) => any} f\n * @returns {any}\n */\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n"],"names":["currentIndex","currentComponent","previousComponent","currentHook","afterPaintEffects","options","_options","oldBeforeDiff","_diff","oldBeforeRender","_render","oldAfterDiff","diffed","oldCommit","_commit","oldBeforeUnmount","unmount","oldRoot","_root","RAF_TIMEOUT","prevRaf","vnode","parentDom","_children","_mask","_component","hooks","__hooks","_pendingEffects","_renderCallbacks","_list","forEach","hookItem","_nextValue","_value","_pendingArgs","undefined","invokeCleanup","invokeEffect","c","length","afterPaint","push","_args","commitQueue","some","component","filter","cb","e","_catchError","_vnode","hasErrored","s","getHookState","index","type","_hook","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_reducer","action","currentValue","nextValue","setState","_hasScuFromHooks","updateHookState","p","isStateHook","x","stateHooks","allHooksEmpty","every","prevScu","call","shouldUpdate","props","shouldComponentUpdate","prevCWU","componentWillUpdate","_force","tmp","useEffect","callback","args","state","_skipEffects","argsChanged","useLayoutEffect","useRef","initialValue","useMemo","current","useImperativeHandle","ref","createHandle","concat","factory","_factory","useCallback","useContext","context","provider","_id","_context","_defaultValue","sub","value","useDebugValue","formatter","useErrorBoundary","errState","componentDidCatch","err","errorInfo","useId","root","_parent","mask","flushAfterPaintEffects","shift","_parentDom","HAS_RAF","requestAnimationFrame","afterNextFrame","done","clearTimeout","timeout","cancelAnimationFrame","raf","setTimeout","newQueueLength","hook","comp","cleanup","_cleanup","oldArgs","newArgs","arg","f"],"mappings":";;;;;CAEA;CACA,IAAIA,YAAY,CAAA;;CAEhB;CACA,IAAIC,gBAAgB,CAAA;;CAEpB;CACA,IAAIC,iBAAiB,CAAA;;CAErB;CACA,IAAIC,WAAW,GAAG,CAAC,CAAA;;CAEnB;CACA,IAAIC,iBAAiB,GAAG,EAAE,CAAA;;CAE1B;CACA,IAAMC,OAAO,8CAAgDC,aAAS,CAAA;CAEtE,IAAIC,aAAa,GAAGF,OAAO,CAACG,KAAK,CAAA;CACjC,IAAIC,eAAe,GAAGJ,OAAO,CAACK,OAAO,CAAA;CACrC,IAAIC,YAAY,GAAGN,OAAO,CAACO,MAAM,CAAA;CACjC,IAAIC,SAAS,GAAGR,OAAO,CAACS,OAAO,CAAA;CAC/B,IAAIC,gBAAgB,GAAGV,OAAO,CAACW,OAAO,CAAA;CACtC,IAAIC,OAAO,GAAGZ,OAAO,CAACa,KAAK,CAAA;CAE3B,IAAMC,WAAW,GAAG,GAAG,CAAA;CACvB,IAAIC,OAAO,CAAA;;CAEX;CACAf,OAAO,CAACG,KAAK,GAAG,UAAAa,KAAK,EAAI;CACxBpB,EAAAA,gBAAgB,GAAG,IAAI,CAAA;CACvB,EAAA,IAAIM,aAAa,EAAEA,aAAa,CAACc,KAAK,CAAC,CAAA;CACxC,CAAC,CAAA;CAEDhB,OAAO,CAACa,KAAK,GAAG,UAACG,KAAK,EAAEC,SAAS,EAAK;GACrC,IAAID,KAAK,IAAIC,SAAS,CAACC,SAAS,IAAID,SAAS,CAACC,SAAS,CAACC,KAAK,EAAE;CAC9DH,IAAAA,KAAK,CAACG,KAAK,GAAGF,SAAS,CAACC,SAAS,CAACC,KAAK,CAAA;CACxC,GAAA;CAEA,EAAA,IAAIP,OAAO,EAAEA,OAAO,CAACI,KAAK,EAAEC,SAAS,CAAC,CAAA;CACvC,CAAC,CAAA;;CAED;CACAjB,OAAO,CAACK,OAAO,GAAG,UAAAW,KAAK,EAAI;CAC1B,EAAA,IAAIZ,eAAe,EAAEA,eAAe,CAACY,KAAK,CAAC,CAAA;GAE3CpB,gBAAgB,GAAGoB,KAAK,CAACI,UAAU,CAAA;CACnCzB,EAAAA,YAAY,GAAG,CAAC,CAAA;CAEhB,EAAA,IAAM0B,KAAK,GAAGzB,gBAAgB,CAAC0B,OAAO,CAAA;CACtC,EAAA,IAAID,KAAK,EAAE;KACV,IAAIxB,iBAAiB,KAAKD,gBAAgB,EAAE;OAC3CyB,KAAK,CAACE,eAAe,GAAG,EAAE,CAAA;OAC1B3B,gBAAgB,CAAC4B,gBAAgB,GAAG,EAAE,CAAA;CACtCH,MAAAA,KAAK,CAACI,KAAK,CAACC,OAAO,CAAC,UAAAC,QAAQ,EAAI;SAC/B,IAAIA,QAAQ,CAACC,UAAU,EAAE;CACxBD,UAAAA,QAAQ,CAACE,MAAM,GAAGF,QAAQ,CAACC,UAAU,CAAA;CACtC,SAAA;CACAD,QAAAA,QAAQ,CAACG,YAAY,GAAGH,QAAQ,CAACC,UAAU,GAAGG,SAAS,CAAA;CACxD,OAAC,CAAC,CAAA;CACH,KAAC,MAAM;CACNV,MAAAA,KAAK,CAACE,eAAe,CAACG,OAAO,CAACM,aAAa,CAAC,CAAA;CAC5CX,MAAAA,KAAK,CAACE,eAAe,CAACG,OAAO,CAACO,YAAY,CAAC,CAAA;OAC3CZ,KAAK,CAACE,eAAe,GAAG,EAAE,CAAA;CAC1B5B,MAAAA,YAAY,GAAG,CAAC,CAAA;CACjB,KAAA;CACD,GAAA;CACAE,EAAAA,iBAAiB,GAAGD,gBAAgB,CAAA;CACrC,CAAC,CAAA;;CAED;CACAI,OAAO,CAACO,MAAM,GAAG,UAAAS,KAAK,EAAI;CACzB,EAAA,IAAIV,YAAY,EAAEA,YAAY,CAACU,KAAK,CAAC,CAAA;CAErC,EAAA,IAAMkB,CAAC,GAAGlB,KAAK,CAACI,UAAU,CAAA;CAC1B,EAAA,IAAIc,CAAC,IAAIA,CAAC,CAACZ,OAAO,EAAE;CACnB,IAAA,IAAIY,CAAC,CAACZ,OAAO,CAACC,eAAe,CAACY,MAAM,EAAEC,UAAU,CAACrC,iBAAiB,CAACsC,IAAI,CAACH,CAAC,CAAC,CAAC,CAAA;KAC3EA,CAAC,CAACZ,OAAO,CAACG,KAAK,CAACC,OAAO,CAAC,UAAAC,QAAQ,EAAI;OACnC,IAAIA,QAAQ,CAACG,YAAY,EAAE;CAC1BH,QAAAA,QAAQ,CAACW,KAAK,GAAGX,QAAQ,CAACG,YAAY,CAAA;CACvC,OAAA;OACAH,QAAQ,CAACG,YAAY,GAAGC,SAAS,CAAA;CAClC,KAAC,CAAC,CAAA;CACH,GAAA;GACAlC,iBAAiB,GAAGD,gBAAgB,GAAG,IAAI,CAAA;CAC5C,CAAC,CAAA;;CAED;CACA;CACAI,OAAO,CAACS,OAAO,GAAG,UAACO,KAAK,EAAEuB,WAAW,EAAK;CACzCA,EAAAA,WAAW,CAACC,IAAI,CAAC,UAAAC,SAAS,EAAI;KAC7B,IAAI;CACHA,MAAAA,SAAS,CAACjB,gBAAgB,CAACE,OAAO,CAACM,aAAa,CAAC,CAAA;OACjDS,SAAS,CAACjB,gBAAgB,GAAGiB,SAAS,CAACjB,gBAAgB,CAACkB,MAAM,CAAC,UAAAC,EAAE,EAAA;SAAA,OAChEA,EAAE,CAACd,MAAM,GAAGI,YAAY,CAACU,EAAE,CAAC,GAAG,IAAI,CAAA;CAAA,OACpC,CAAC,CAAA;MACD,CAAC,OAAOC,CAAC,EAAE;CACXL,MAAAA,WAAW,CAACC,IAAI,CAAC,UAAAN,CAAC,EAAI;SACrB,IAAIA,CAAC,CAACV,gBAAgB,EAAEU,CAAC,CAACV,gBAAgB,GAAG,EAAE,CAAA;CAChD,OAAC,CAAC,CAAA;CACFe,MAAAA,WAAW,GAAG,EAAE,CAAA;OAChBvC,OAAO,CAAC6C,WAAW,CAACD,CAAC,EAAEH,SAAS,CAACK,MAAM,CAAC,CAAA;CACzC,KAAA;CACD,GAAC,CAAC,CAAA;CAEF,EAAA,IAAItC,SAAS,EAAEA,SAAS,CAACQ,KAAK,EAAEuB,WAAW,CAAC,CAAA;CAC7C,CAAC,CAAA;;CAED;CACAvC,OAAO,CAACW,OAAO,GAAG,UAAAK,KAAK,EAAI;CAC1B,EAAA,IAAIN,gBAAgB,EAAEA,gBAAgB,CAACM,KAAK,CAAC,CAAA;CAE7C,EAAA,IAAMkB,CAAC,GAAGlB,KAAK,CAACI,UAAU,CAAA;CAC1B,EAAA,IAAIc,CAAC,IAAIA,CAAC,CAACZ,OAAO,EAAE;CACnB,IAAA,IAAIyB,UAAU,CAAA;KACdb,CAAC,CAACZ,OAAO,CAACG,KAAK,CAACC,OAAO,CAAC,UAAAsB,CAAC,EAAI;OAC5B,IAAI;SACHhB,aAAa,CAACgB,CAAC,CAAC,CAAA;QAChB,CAAC,OAAOJ,CAAC,EAAE;CACXG,QAAAA,UAAU,GAAGH,CAAC,CAAA;CACf,OAAA;CACD,KAAC,CAAC,CAAA;KACFV,CAAC,CAACZ,OAAO,GAAGS,SAAS,CAAA;KACrB,IAAIgB,UAAU,EAAE/C,OAAO,CAAC6C,WAAW,CAACE,UAAU,EAAEb,CAAC,CAACY,MAAM,CAAC,CAAA;CAC1D,GAAA;CACD,CAAC,CAAA;;CAED;CACA;CACA;CACA;CACA;CACA;CACA,SAASG,YAAYA,CAACC,KAAK,EAAEC,IAAI,EAAE;GAClC,IAAInD,OAAO,CAACoD,KAAK,EAAE;KAClBpD,OAAO,CAACoD,KAAK,CAACxD,gBAAgB,EAAEsD,KAAK,EAAEpD,WAAW,IAAIqD,IAAI,CAAC,CAAA;CAC5D,GAAA;CACArD,EAAAA,WAAW,GAAG,CAAC,CAAA;;CAEf;CACA;CACA;CACA;CACA;GACA,IAAMuB,KAAK,GACVzB,gBAAgB,CAAC0B,OAAO,KACvB1B,gBAAgB,CAAC0B,OAAO,GAAG;CAC3BG,IAAAA,KAAK,EAAE,EAAE;CACTF,IAAAA,eAAe,EAAE,EAAA;CAClB,GAAC,CAAC,CAAA;CAEH,EAAA,IAAI2B,KAAK,IAAI7B,KAAK,CAACI,KAAK,CAACU,MAAM,EAAE;CAChCd,IAAAA,KAAK,CAACI,KAAK,CAACY,IAAI,CAAC,EAAE,CAAC,CAAA;CACrB,GAAA;CAEA,EAAA,OAAOhB,KAAK,CAACI,KAAK,CAACyB,KAAK,CAAC,CAAA;CAC1B,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAASG,QAAQA,CAACC,YAAY,EAAE;CACtCxD,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf,EAAA,OAAOyD,UAAU,CAACC,cAAc,EAAEF,YAAY,CAAC,CAAA;CAChD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACO,SAASC,UAAUA,CAACE,OAAO,EAAEH,YAAY,EAAEI,IAAI,EAAE;CACvD;GACA,IAAMC,SAAS,GAAGV,YAAY,CAACtD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;GACjDgE,SAAS,CAACC,QAAQ,GAAGH,OAAO,CAAA;CAC5B,EAAA,IAAI,CAACE,SAAS,CAACvC,UAAU,EAAE;KAC1BuC,SAAS,CAAC9B,MAAM,GAAG,CAClB,CAAC6B,IAAI,GAAGF,cAAc,CAACzB,SAAS,EAAEuB,YAAY,CAAC,GAAGI,IAAI,CAACJ,YAAY,CAAC,EAEpE,UAAAO,MAAM,EAAI;CACT,MAAA,IAAMC,YAAY,GAAGH,SAAS,CAAC/B,UAAU,GACtC+B,SAAS,CAAC/B,UAAU,CAAC,CAAC,CAAC,GACvB+B,SAAS,CAAC9B,MAAM,CAAC,CAAC,CAAC,CAAA;OACtB,IAAMkC,SAAS,GAAGJ,SAAS,CAACC,QAAQ,CAACE,YAAY,EAAED,MAAM,CAAC,CAAA;OAE1D,IAAIC,YAAY,KAAKC,SAAS,EAAE;CAC/BJ,QAAAA,SAAS,CAAC/B,UAAU,GAAG,CAACmC,SAAS,EAAEJ,SAAS,CAAC9B,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;CACvD8B,QAAAA,SAAS,CAACvC,UAAU,CAAC4C,QAAQ,CAAC,EAAE,CAAC,CAAA;CAClC,OAAA;CACD,KAAC,CACD,CAAA;KAEDL,SAAS,CAACvC,UAAU,GAAGxB,gBAAgB,CAAA;CAEvC,IAAA,IAAI,CAACA,gBAAgB,CAACqE,gBAAgB,EAAE;CAoBvC;CACA;CACA;CACA;CACA;CACA;CACA;CACH;CACA;CACA;CACG;CACA;OAAA,IACSC,eAAe,GAAxB,SAASA,eAAeA,CAACC,CAAC,EAAEnB,CAAC,EAAEd,CAAC,EAAE;SACjC,IAAI,CAACyB,SAAS,CAACvC,UAAU,CAACE,OAAO,EAAE,OAAO,IAAI,CAAA;;CAE9C;CACA,QAAA,IAAM8C,WAAW,GAAG,SAAdA,WAAWA,CAAGC,CAAC,EAAA;CAAA,UAAA,OAAI,CAAC,CAACA,CAAC,CAACjD,UAAU,CAAA;CAAA,SAAA,CAAA;CACvC,QAAA,IAAMkD,UAAU,GACfX,SAAS,CAACvC,UAAU,CAACE,OAAO,CAACG,KAAK,CAACiB,MAAM,CAAC0B,WAAW,CAAC,CAAA;CAEvD,QAAA,IAAMG,aAAa,GAAGD,UAAU,CAACE,KAAK,CAAC,UAAAH,CAAC,EAAA;WAAA,OAAI,CAACA,CAAC,CAACzC,UAAU,CAAA;UAAC,CAAA,CAAA;CAC1D;CACA;CACA,QAAA,IAAI2C,aAAa,EAAE;CAClB,UAAA,OAAOE,OAAO,GAAGA,OAAO,CAACC,IAAI,CAAC,IAAI,EAAEP,CAAC,EAAEnB,CAAC,EAAEd,CAAC,CAAC,GAAG,IAAI,CAAA;CACpD,SAAA;;CAEA;CACA;CACA;SACA,IAAIyC,YAAY,GAAG,KAAK,CAAA;CACxBL,QAAAA,UAAU,CAAC5C,OAAO,CAAC,UAAAC,QAAQ,EAAI;WAC9B,IAAIA,QAAQ,CAACC,UAAU,EAAE;CACxB,YAAA,IAAMkC,YAAY,GAAGnC,QAAQ,CAACE,MAAM,CAAC,CAAC,CAAC,CAAA;CACvCF,YAAAA,QAAQ,CAACE,MAAM,GAAGF,QAAQ,CAACC,UAAU,CAAA;aACrCD,QAAQ,CAACC,UAAU,GAAGG,SAAS,CAAA;aAC/B,IAAI+B,YAAY,KAAKnC,QAAQ,CAACE,MAAM,CAAC,CAAC,CAAC,EAAE8C,YAAY,GAAG,IAAI,CAAA;CAC7D,WAAA;CACD,SAAC,CAAC,CAAA;SAEF,OAAOA,YAAY,IAAIhB,SAAS,CAACvC,UAAU,CAACwD,KAAK,KAAKT,CAAC,GACpDM,OAAO,GACNA,OAAO,CAACC,IAAI,CAAC,IAAI,EAAEP,CAAC,EAAEnB,CAAC,EAAEd,CAAC,CAAC,GAC3B,IAAI,GACL,KAAK,CAAA;QACR,CAAA;OAhEDtC,gBAAgB,CAACqE,gBAAgB,GAAG,IAAI,CAAA;CACxC,MAAA,IAAIQ,OAAO,GAAG7E,gBAAgB,CAACiF,qBAAqB,CAAA;CACpD,MAAA,IAAMC,OAAO,GAAGlF,gBAAgB,CAACmF,mBAAmB,CAAA;;CAEpD;CACA;CACA;OACAnF,gBAAgB,CAACmF,mBAAmB,GAAG,UAAUZ,CAAC,EAAEnB,CAAC,EAAEd,CAAC,EAAE;SACzD,IAAI,IAAI,CAAC8C,MAAM,EAAE;WAChB,IAAIC,GAAG,GAAGR,OAAO,CAAA;CACjB;CACAA,UAAAA,OAAO,GAAG1C,SAAS,CAAA;CACnBmC,UAAAA,eAAe,CAACC,CAAC,EAAEnB,CAAC,EAAEd,CAAC,CAAC,CAAA;CACxBuC,UAAAA,OAAO,GAAGQ,GAAG,CAAA;CACd,SAAA;CAEA,QAAA,IAAIH,OAAO,EAAEA,OAAO,CAACJ,IAAI,CAAC,IAAI,EAAEP,CAAC,EAAEnB,CAAC,EAAEd,CAAC,CAAC,CAAA;QACxC,CAAA;OAiDDtC,gBAAgB,CAACiF,qBAAqB,GAAGX,eAAe,CAAA;CACzD,KAAA;CACD,GAAA;CAEA,EAAA,OAAOP,SAAS,CAAC/B,UAAU,IAAI+B,SAAS,CAAC9B,MAAM,CAAA;CAChD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAASqD,SAASA,CAACC,QAAQ,EAAEC,IAAI,EAAE;CACzC;GACA,IAAMC,KAAK,GAAGpC,YAAY,CAACtD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;CAC7C,EAAA,IAAI,CAACK,OAAO,CAACsF,YAAY,IAAIC,WAAW,CAACF,KAAK,CAAC/C,KAAK,EAAE8C,IAAI,CAAC,EAAE;KAC5DC,KAAK,CAACxD,MAAM,GAAGsD,QAAQ,CAAA;KACvBE,KAAK,CAACvD,YAAY,GAAGsD,IAAI,CAAA;KAEzBxF,gBAAgB,CAAC0B,OAAO,CAACC,eAAe,CAACc,IAAI,CAACgD,KAAK,CAAC,CAAA;CACrD,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAASG,eAAeA,CAACL,QAAQ,EAAEC,IAAI,EAAE;CAC/C;GACA,IAAMC,KAAK,GAAGpC,YAAY,CAACtD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;CAC7C,EAAA,IAAI,CAACK,OAAO,CAACsF,YAAY,IAAIC,WAAW,CAACF,KAAK,CAAC/C,KAAK,EAAE8C,IAAI,CAAC,EAAE;KAC5DC,KAAK,CAACxD,MAAM,GAAGsD,QAAQ,CAAA;KACvBE,KAAK,CAACvD,YAAY,GAAGsD,IAAI,CAAA;CAEzBxF,IAAAA,gBAAgB,CAAC4B,gBAAgB,CAACa,IAAI,CAACgD,KAAK,CAAC,CAAA;CAC9C,GAAA;CACD,CAAA;;CAEA;CACO,SAASI,MAAMA,CAACC,YAAY,EAAE;CACpC5F,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf,EAAA,OAAO6F,OAAO,CAAC,YAAA;KAAA,OAAO;CAAEC,MAAAA,OAAO,EAAEF,YAAAA;MAAc,CAAA;IAAC,EAAE,EAAE,CAAC,CAAA;CACtD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACO,SAASG,mBAAmBA,CAACC,GAAG,EAAEC,YAAY,EAAEX,IAAI,EAAE;CAC5DtF,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf0F,EAAAA,eAAe,CACd,YAAM;CACL,IAAA,IAAI,OAAOM,GAAG,IAAI,UAAU,EAAE;CAC7BA,MAAAA,GAAG,CAACC,YAAY,EAAE,CAAC,CAAA;OACnB,OAAO,YAAA;SAAA,OAAMD,GAAG,CAAC,IAAI,CAAC,CAAA;CAAA,OAAA,CAAA;MACtB,MAAM,IAAIA,GAAG,EAAE;CACfA,MAAAA,GAAG,CAACF,OAAO,GAAGG,YAAY,EAAE,CAAA;OAC5B,OAAO,YAAA;CAAA,QAAA,OAAOD,GAAG,CAACF,OAAO,GAAG,IAAI,CAAA;QAAC,CAAA;CAClC,KAAA;CACD,GAAC,EACDR,IAAI,IAAI,IAAI,GAAGA,IAAI,GAAGA,IAAI,CAACY,MAAM,CAACF,GAAG,CACtC,CAAC,CAAA;CACF,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACO,SAASH,OAAOA,CAACM,OAAO,EAAEb,IAAI,EAAE;CACtC;GACA,IAAMC,KAAK,GAAGpC,YAAY,CAACtD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;GAC7C,IAAI4F,WAAW,CAACF,KAAK,CAAC/C,KAAK,EAAE8C,IAAI,CAAC,EAAE;CACnCC,IAAAA,KAAK,CAACxD,MAAM,GAAGoE,OAAO,EAAE,CAAA;KACxBZ,KAAK,CAAC/C,KAAK,GAAG8C,IAAI,CAAA;KAClBC,KAAK,CAACa,QAAQ,GAAGD,OAAO,CAAA;CACzB,GAAA;GAEA,OAAOZ,KAAK,CAACxD,MAAM,CAAA;CACpB,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACO,SAASsE,WAAWA,CAAChB,QAAQ,EAAEC,IAAI,EAAE;CAC3CtF,EAAAA,WAAW,GAAG,CAAC,CAAA;CACf,EAAA,OAAO6F,OAAO,CAAC,YAAA;CAAA,IAAA,OAAMR,QAAQ,CAAA;CAAA,GAAA,EAAEC,IAAI,CAAC,CAAA;CACrC,CAAA;;CAEA;CACA;CACA;CACO,SAASgB,UAAUA,CAACC,OAAO,EAAE;GACnC,IAAMC,QAAQ,GAAG1G,gBAAgB,CAACyG,OAAO,CAACA,OAAO,CAACE,GAAG,CAAC,CAAA;CACtD;CACA;CACA;CACA;GACA,IAAMlB,KAAK,GAAGpC,YAAY,CAACtD,YAAY,EAAE,EAAE,CAAC,CAAC,CAAA;CAC7C;CACA;CACA;GACA0F,KAAK,CAACmB,QAAQ,GAAGH,OAAO,CAAA;CACxB,EAAA,IAAI,CAACC,QAAQ,EAAE,OAAOD,OAAO,CAACI,aAAa,CAAA;CAC3C;CACA,EAAA,IAAIpB,KAAK,CAACxD,MAAM,IAAI,IAAI,EAAE;KACzBwD,KAAK,CAACxD,MAAM,GAAG,IAAI,CAAA;CACnByE,IAAAA,QAAQ,CAACI,GAAG,CAAC9G,gBAAgB,CAAC,CAAA;CAC/B,GAAA;CACA,EAAA,OAAO0G,QAAQ,CAAC1B,KAAK,CAAC+B,KAAK,CAAA;CAC5B,CAAA;;CAEA;CACA;CACA;CACA;CACO,SAASC,aAAaA,CAACD,KAAK,EAAEE,SAAS,EAAE;GAC/C,IAAI7G,OAAO,CAAC4G,aAAa,EAAE;CAC1B5G,IAAAA,OAAO,CAAC4G,aAAa,CACpBC,SAAS,GAAGA,SAAS,CAACF,KAAK,CAAC,sBAAsBA,KAAK,CACxD,CAAC,CAAA;CACF,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACO,SAASG,gBAAgBA,CAACnE,EAAE,EAAE;CACpC;GACA,IAAM0C,KAAK,GAAGpC,YAAY,CAACtD,YAAY,EAAE,EAAE,EAAE,CAAC,CAAA;CAC9C,EAAA,IAAMoH,QAAQ,GAAG1D,QAAQ,EAAE,CAAA;GAC3BgC,KAAK,CAACxD,MAAM,GAAGc,EAAE,CAAA;CACjB,EAAA,IAAI,CAAC/C,gBAAgB,CAACoH,iBAAiB,EAAE;CACxCpH,IAAAA,gBAAgB,CAACoH,iBAAiB,GAAG,UAACC,GAAG,EAAEC,SAAS,EAAK;OACxD,IAAI7B,KAAK,CAACxD,MAAM,EAAEwD,KAAK,CAACxD,MAAM,CAACoF,GAAG,EAAEC,SAAS,CAAC,CAAA;CAC9CH,MAAAA,QAAQ,CAAC,CAAC,CAAC,CAACE,GAAG,CAAC,CAAA;MAChB,CAAA;CACF,GAAA;CACA,EAAA,OAAO,CACNF,QAAQ,CAAC,CAAC,CAAC,EACX,YAAM;CACLA,IAAAA,QAAQ,CAAC,CAAC,CAAC,CAAChF,SAAS,CAAC,CAAA;CACvB,GAAC,CACD,CAAA;CACF,CAAA;;CAEA;CACO,SAASoF,KAAKA,GAAG;CACvB;GACA,IAAM9B,KAAK,GAAGpC,YAAY,CAACtD,YAAY,EAAE,EAAE,EAAE,CAAC,CAAA;CAC9C,EAAA,IAAI,CAAC0F,KAAK,CAACxD,MAAM,EAAE;CAClB;CACA;CACA,IAAA,IAAIuF,IAAI,GAAGxH,gBAAgB,CAACkD,MAAM,CAAA;CAClC,IAAA,OAAOsE,IAAI,KAAK,IAAI,IAAI,CAACA,IAAI,CAACjG,KAAK,IAAIiG,IAAI,CAACC,OAAO,KAAK,IAAI,EAAE;OAC7DD,IAAI,GAAGA,IAAI,CAACC,OAAO,CAAA;CACpB,KAAA;CAEA,IAAA,IAAIC,IAAI,GAAGF,IAAI,CAACjG,KAAK,KAAKiG,IAAI,CAACjG,KAAK,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;CAC9CkE,IAAAA,KAAK,CAACxD,MAAM,GAAG,GAAG,GAAGyF,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,IAAI,CAAC,CAAC,CAAC,EAAE,CAAA;CAC/C,GAAA;GAEA,OAAOjC,KAAK,CAACxD,MAAM,CAAA;CACpB,CAAA;;CAEA;CACA;CACA;CACA,SAAS0F,sBAAsBA,GAAG;CACjC,EAAA,IAAI9E,SAAS,CAAA;CACb,EAAA,OAAQA,SAAS,GAAG1C,iBAAiB,CAACyH,KAAK,EAAE,EAAG;KAC/C,IAAI,CAAC/E,SAAS,CAACgF,UAAU,IAAI,CAAChF,SAAS,CAACnB,OAAO,EAAE,SAAA;KACjD,IAAI;OACHmB,SAAS,CAACnB,OAAO,CAACC,eAAe,CAACG,OAAO,CAACM,aAAa,CAAC,CAAA;OACxDS,SAAS,CAACnB,OAAO,CAACC,eAAe,CAACG,OAAO,CAACO,YAAY,CAAC,CAAA;CACvDQ,MAAAA,SAAS,CAACnB,OAAO,CAACC,eAAe,GAAG,EAAE,CAAA;MACtC,CAAC,OAAOqB,CAAC,EAAE;CACXH,MAAAA,SAAS,CAACnB,OAAO,CAACC,eAAe,GAAG,EAAE,CAAA;OACtCvB,OAAO,CAAC6C,WAAW,CAACD,CAAC,EAAEH,SAAS,CAACK,MAAM,CAAC,CAAA;CACzC,KAAA;CACD,GAAA;CACD,CAAA;CAEA,IAAI4E,OAAO,GAAG,OAAOC,qBAAqB,IAAI,UAAU,CAAA;;CAExD;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA,SAASC,cAAcA,CAACzC,QAAQ,EAAE;CACjC,EAAA,IAAM0C,IAAI,GAAG,SAAPA,IAAIA,GAAS;KAClBC,YAAY,CAACC,OAAO,CAAC,CAAA;CACrB,IAAA,IAAIL,OAAO,EAAEM,oBAAoB,CAACC,GAAG,CAAC,CAAA;KACtCC,UAAU,CAAC/C,QAAQ,CAAC,CAAA;IACpB,CAAA;CACD,EAAA,IAAM4C,OAAO,GAAGG,UAAU,CAACL,IAAI,EAAE/G,WAAW,CAAC,CAAA;CAE7C,EAAA,IAAImH,GAAG,CAAA;CACP,EAAA,IAAIP,OAAO,EAAE;CACZO,IAAAA,GAAG,GAAGN,qBAAqB,CAACE,IAAI,CAAC,CAAA;CAClC,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACA;CACA;CACA,SAASzF,UAAUA,CAAC+F,cAAc,EAAE;GACnC,IAAIA,cAAc,KAAK,CAAC,IAAIpH,OAAO,KAAKf,OAAO,CAAC2H,qBAAqB,EAAE;KACtE5G,OAAO,GAAGf,OAAO,CAAC2H,qBAAqB,CAAA;CACvC,IAAA,CAAC5G,OAAO,IAAI6G,cAAc,EAAEL,sBAAsB,CAAC,CAAA;CACpD,GAAA;CACD,CAAA;;CAEA;CACA;CACA;CACA;CACA,SAASvF,aAAaA,CAACoG,IAAI,EAAE;CAC5B;CACA;GACA,IAAMC,IAAI,GAAGzI,gBAAgB,CAAA;CAC7B,EAAA,IAAI0I,OAAO,GAAGF,IAAI,CAACG,QAAQ,CAAA;CAC3B,EAAA,IAAI,OAAOD,OAAO,IAAI,UAAU,EAAE;KACjCF,IAAI,CAACG,QAAQ,GAAGxG,SAAS,CAAA;CACzBuG,IAAAA,OAAO,EAAE,CAAA;CACV,GAAA;CAEA1I,EAAAA,gBAAgB,GAAGyI,IAAI,CAAA;CACxB,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA,SAASpG,YAAYA,CAACmG,IAAI,EAAE;CAC3B;CACA;GACA,IAAMC,IAAI,GAAGzI,gBAAgB,CAAA;CAC7BwI,EAAAA,IAAI,CAACG,QAAQ,GAAGH,IAAI,CAACvG,MAAM,EAAE,CAAA;CAC7BjC,EAAAA,gBAAgB,GAAGyI,IAAI,CAAA;CACxB,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA,SAAS9C,WAAWA,CAACiD,OAAO,EAAEC,OAAO,EAAE;CACtC,EAAA,OACC,CAACD,OAAO,IACRA,OAAO,CAACrG,MAAM,KAAKsG,OAAO,CAACtG,MAAM,IACjCsG,OAAO,CAACjG,IAAI,CAAC,UAACkG,GAAG,EAAExF,KAAK,EAAA;CAAA,IAAA,OAAKwF,GAAG,KAAKF,OAAO,CAACtF,KAAK,CAAC,CAAA;IAAC,CAAA,CAAA;CAEtD,CAAA;;CAEA;CACA;CACA;CACA;CACA;CACA;CACA,SAASM,cAAcA,CAACkF,GAAG,EAAEC,CAAC,EAAE;GAC/B,OAAO,OAAOA,CAAC,IAAI,UAAU,GAAGA,CAAC,CAACD,GAAG,CAAC,GAAGC,CAAC,CAAA;CAC3C;;;;;;;;;;;;;;;;;;;"}